(()=>{"use strict";const t=document.getElementById("button1"),e=document.getElementById("button2"),i=document.getElementById("button3"),n=document.getElementById("button4"),o=document.getElementById("button5"),s=document.getElementById("desc"),a=document.getElementById("round-count"),r=document.getElementById("point-counter"),d=document.getElementById("token-counter"),l=document.getElementById("respect-counter"),u=document.getElementById("exchange-tokens");let h;var c,y,p;function m(s="",a="",r="",d="",l=""){t.innerHTML=s,e.innerHTML=a,i.innerHTML=r,n.innerHTML=d,o.innerHTML=l}function f(t,e,i=""){a.innerHTML=`Round ${t}: ${e}`,s.innerHTML=i}!function(t){t[t.Building=0]="Building",t[t.Trading=1]="Trading",t[t.Raiding=2]="Raiding"}(c||(c={})),function(t){t[t.Easy=0]="Easy",t[t.Normal=1]="Normal",t[t.Hard=2]="Hard"}(y||(y={})),function(t){t[t.Floodplains=0]="Floodplains",t[t.Desert=1]="Desert",t[t.Mountains=2]="Mountains"}(p||(p={}));class b{roundInstance;constructor(t){this.roundInstance=t}celebrations(){f(this.roundInstance.getRound(),"Celebrations","You've made it this far, and got celebrations from another civilization.<br>Gained 5 points."),this.roundInstance.addPts(5)}thermonuclearWarhead(){f(this.roundInstance.getRound(),"Thermonuclear Warhead","Oh no! Another civilization launhed a thermonuclear warhead at you!<br>Lost 20 points."),this.roundInstance.addPts(-20)}asteroid(){f(this.roundInstance.getRound(),"Asteroid!","A gigantic asteroid from outer space hit your civilization.<br>Lost 30 points."),this.roundInstance.addPts(-30)}UFO(){f(this.roundInstance.getRound(),"UFO!","A UFO came around and absolutely obliterated your civilization.<br>Lost 50 points."),this.roundInstance.addPts(-50)}gifts(){f(this.roundInstance.getRound(),"Gifts!","A lot of civilizations came and gave you gifts.<br>Gained 10 points."),this.roundInstance.addPts(10)}goodUFO(){f(this.roundInstance.getRound(),"Alien Gifts!","A foreign civilization from another planet personally visited you to give you some gifts.<br>Gained 20 points."),this.roundInstance.addPts(20)}}class g{roundInstance;constructor(t){this.roundInstance=t}tokensToPts(){this.roundInstance.getTokens()>0&&(this.roundInstance.addPts(3),this.roundInstance.modifyTokens(-1))}}class T{civilization;pts;focus;roundNum;emergencyWater;happiness;hasTribute;faminePotential;builtLess;immunity;difficulty;tornadoEffects;respect;tokens;specialMethods;constructor(t,e,i,n){this.civilization=t,this.pts=e,this.focus=i,this.difficulty=n,this.roundNum=0,this.emergencyWater=!1,this.happiness=3,this.hasTribute=!1,this.faminePotential=!1,this.builtLess=!1,this.immunity=!1,this.tornadoEffects=0,this.respect=0,this.tokens=0,this.specialMethods=new b(this)}async randomEvent(){switch(Math.floor(10*Math.random())){case 0:this.plague();break;case 1:this.flood();break;case 2:this.trade();break;case 3:await this.gold();break;case 4:this.waterShortage();break;case 5:await this.buy();break;case 6:this.farms();break;case 7:this.tornado();break;case 8:await this.resources();break;case 9:this.famine()}}async newRound(){this.roundNum++,this.happiness<=0?this.revolution():this.roundNum%50==0?this.difficulty===y.Hard?this.specialMethods.UFO():this.specialMethods.goodUFO():this.roundNum%30==0?this.difficulty===y.Hard?this.specialMethods.asteroid():this.specialMethods.gifts():this.roundNum%15==0?this.difficulty===y.Hard?this.specialMethods.thermonuclearWarhead():this.specialMethods.celebrations():this.roundNum%10==0?this.raid():this.roundNum%5==0?await this.waterChoice():await this.randomEvent(),this.tornadoEffects>0&&(this.pts--,this.tornadoEffects--)}getRound(){return this.roundNum}getPts(){return this.pts}addPts(t){this.pts+=t}getTokens(){return this.tokens}modifyTokens(t){this.tokens+=t}getRespect(){return this.respect}plague(){f(this.roundNum,"Plague",this.immunity?"Your civilization was hit by a plague but you had immunity.<br>Lost 1 point.":"Your civilization was hit by a heavy plague.<br>Lost 4 points"),this.immunity?this.pts--:this.pts-=4,this.immunity=!this.immunity}flood(){switch(a.innerHTML=`Round ${this.roundNum}: Flood`,this.civilization){case p.Floodplains:s.innerHTML="The floods absolutely devoured your civilization with no mercy.<br>Lost 4 points.",this.pts-=4;break;case p.Mountains:s.innerHTML="The floods did a minor toll on your civilization.<br>Lost 2 points.",this.pts-=2;break;case p.Desert:s.innerHTML="You heard news that a flood happened nearby. However, being in the desert, there is a lack of water.<br>No points gained or lost."}}waterChoice(){return a.innerHTML=`Round ${this.roundNum}: Water Situation`,s.innerHTML="You discover that you have an excess supply of water. What do you want to do with the exccess water?",t.style.display="flex",e.style.display="flex",m("Irrigate the crops",this.emergencyWater?"Already excess water":"Save the water"),this.emergencyWater&&(e.disabled=!0),new Promise((i=>{t.onclick=()=>{s.innerHTML="You irrigate the crops and they seem to grow a lot better.<br>Gained 3 points.",this.pts+=3,e.disabled=!1,i()},e.onclick=()=>{s.innerHTML="You decide to think for the future and save your excess water for later use. Perhaps this might come in useful later...?<br>No points gained or lost.",this.respect++,this.emergencyWater=!0,i()}}))}gold(){return a.innerHTML=`Round ${this.roundNum}: Gold!`,s.innerHTML="You struck gold, a valuable resource! What would you like to do with it?",t.style.display="flex",e.style.display="flex",i.style.display="flex",m("Take it all","Give them to the people","Pay tribute to the gods"),new Promise((n=>{t.onclick=()=>{s.innerHTML="You took all the gold for yourself, because you are king of this civilization. However, not that many people are happy with your decision...<br>Gained 3 points.",this.happiness-=Math.floor(2*Math.random())+1,this.pts+=3,n()},e.onclick=()=>{s.innerHTML="You decided that sharing is caring and gave them all to the people, because communism. The people seemed happy, but you didn't really get anything.<br>No points gained or lost, but this may not be a bad thing...",this.respect+=2,this.happiness++,n()},i.onclick=()=>{s.innerHTML="The gods should be honored was what you decided. Your people agree with this as that will probably be the best use scenario - satisfying the gods so that they could protect you, but this will only come in handy later...<br>No points gained or lost.",this.respect++,this.hasTribute=!0,n()}}))}raid(){f(this.roundNum,"Raid"),this.hasTribute?(s.innerHTML="The civilization is trying to raid you, and they found your tribute and took it and left. At least it didn't crumble...<br>No points gained or lost.",this.hasTribute=!1):this.focus===c.Raiding?(s.innerHTML="The civilization is trying to raid you, but you, being raiders, defended yourself quite well.<br>Lost 2 points.",this.pts-=2):(s.innerHTML="The civilization has raided you and took everything valuable in your civilization with no mercy.<br>Lost 5 points.",this.pts-=5)}trade(){f(this.roundNum,"Trades",this.focus===c.Trading?"You bargained with the civlization and got some extra.<br>Gained 5 points.":"You made some trades.<br>Gained 3 points."),this.focus+=this.focus===c.Trading?5:3}waterShortage(){a.innerHTML=`Round ${this.roundNum}: Water Shortage`;const t=Math.floor(3*Math.random())+2;this.emergencyWater?(s.innerHTML="There has been a water shortage, but luckily, you thought beforehand and used the preserved water.",this.emergencyWater=!1):(s.innerHTML=`There has been a water shortage, and since you didn't have a backup water source, some people died of dehydration.<br>Lost ${t} points.`,this.pts-=t)}revolution(){f(this.roundNum,"Revolution","Due to your bad decisions, your people hate you and rebelled against you.<br>Lost 10 points."),this.pts-=10}buy(){return f(this.roundNum,"Build","Your people ask for you to build some more things. What do you wish to build?"),t.style.display="flex",e.style.display="flex",i.style.display="flex",n.style.display="flex",o.style.display="flex",m("Schools","Roads","Healthcare","Temple","Nothing"),new Promise((a=>{t.onclick=()=>{s.innerHTML="Your people decided that for whatever reason, schools were not the main priority, which is probably expected from civilians that did not get much education.<br>Lost 2 points.",this.pts-=2,a()},e.onclick=()=>{s.innerHTML="Out of all the things that you could've spent the civilization's resources on, you decided that roads would be the main priority. It is no wonder that your people aren't happy.<br>Lost 3 points.",this.pts-=3,a()},i.onclick=()=>{s.innerHTML="You actually decide to spend your resources on something actually good! But, this was a massive fail because your people did not know how to treat patients, but it was an epic fail.<br>Lost 1 point.",this.pts--,a()},n.onclick=()=>{s.innerHTML="Worshipping your gods were your top priority, but it didn't really sit well with your people because you could've spent it on something more immediately beneficial to your civilization.<br>Lost 2 points.",this.pts-=2,a()},o.onclick=()=>{s.innerHTML="You decided not listen to your people and your people were not very happy about it.<br>Lost 4 points.",this.pts-=4,this.builtLess=!0,a()}}))}farms(){switch(a.innerHTML=`Round ${this.roundNum}: Farm Success`,this.civilization){case p.Floodplains:s.innerHTML="Your farms grew extremely successful, and paired with the fertile soil of the floodplains, you gained a lot.<br>Gained 5 points.",this.pts+=5;break;case p.Mountains:s.innerHTML="Your farms grew quite successful in your civilization.<br>Gained 3 points.",this.pts+=3;break;case p.Desert:s.innerHTML="Your farms grew a little successful in your civilization.<br>Gained 1 point.",this.pts++}}tornado(){a.innerHTML=`Round ${this.roundNum}: Tornado`,this.focus===c.Building?(s.innerHTML="A tornado went through your civilization, but since your civilization was specialized in building, it was quite fortified and you also repaired it with ease.<br>Lost 1 point.",this.pts--):(s.innerHTML="A tornado did a major toll on your civilization, and you don't see much recovery anytime soon.<br>Lost 5 points.",this.pts-=5,this.difficulty===y.Hard?this.tornadoEffects=4:this.difficulty===y.Normal?this.tornadoEffects=3:this.tornadoEffects=2)}resources(){if(this.faminePotential)return new Promise((t=>{this.famine(),t()}));if(f(h.roundNum,"Resource Crisis","You are running out of resources. What do you do?"),this.builtLess)return new Promise((t=>{s.innerHTML="You almost had a resource crisis, but due to you building less, it didn't really have an effect, but after that, your building speed has gone back to normal.<br>Lost 1 point.",this.pts--,this.builtLess=!1,t()}));switch(t.style.display="flex",e.style.display="flex",t.innerHTML="Do nothing",this.focus){case c.Building:return e.innerHTML="Build less",new Promise((i=>{t.onclick=()=>{s.innerHTML="You decide to do nothing about it.<br>Lost 4 points.",this.pts-=4,i()},e.onclick=()=>{s.innerHTML="You decide to build less, but that was a big problem because your civilization is primarily focused on building.<br>Lost 6 points.",this.pts-=6,this.builtLess=!0,i()}}));case c.Trading:return e.innerHTML="Trade with other civilizations",new Promise((i=>{t.onclick=()=>{s.innerHTML="You did nothing about the resource crisis.<br>Lost 4 points.",this.pts-=4,i()},e.onclick=()=>{s.innerHTML="You traded with another civilization with your food to try to avoid it. However, now your food is little.<br>No points gained or lost.",this.faminePotential=!0,i()}}));case c.Raiding:return e.innerHTML="Raid another civilization",new Promise((i=>{t.onclick=()=>{s.innerHTML="You did nothing about the resource crisis.<br>Lost 3 points.",this.pts-=3,i()},e.onclick=()=>{0===Math.floor(2*Math.random())?(s.innerHTML="You decided to raid another civilization and lost.<br>Lost 6 points.",this.pts-=6,i()):(s.innerHTML="You decided to raid another civilization and won.<br>Gained 3 points.",this.pts+=3,i())}}));default:return new Promise((t=>{console.error("unknown civilization detected"),t()}))}}famine(){f(this.roundNum,"Famine","You had a famine and it hit really hard.<br>Lost 9 points."),this.pts-=9,this.faminePotential=!1}}function L(n=!1,o=!1,s=!1){return new Promise(n?n=>{t.onclick=()=>n(p.Floodplains),e.onclick=()=>n(p.Mountains),i.onclick=()=>n(p.Desert)}:o?n=>{t.onclick=()=>n(c.Building),e.onclick=()=>n(c.Trading),i.onclick=()=>n(c.Raiding)}:s?n=>{t.onclick=()=>n(y.Easy),e.onclick=()=>n(y.Normal),i.onclick=()=>n(y.Hard)}:e=>{t.onclick=()=>e("")})}const w={floodplains:10,mountains:8,desert:5};t.onclick=()=>async function(){s.textContent="Choose your environment.",t.innerHTML="Floodplains",e.innerHTML="Mountains",i.innerHTML="Desert",t.style.display="flex",e.style.display="flex",i.style.display="flex";const a=await L(!0,!1,!1);s.innerHTML="Choose the focus of your civilization",t.innerHTML="Building",e.innerHTML="Trading",i.innerHTML="Raiding";const c=await L(!1,!0,!1);s.innerHTML="Choose the difficulty",t.innerHTML="Easy",e.innerHTML="Normal",i.innerHTML="Hard",async function(a,c,y){h=new T(a,w[a],c,y);const p=new g(h);for(s.innerHTML=`You have chosen ${a}.`,t.innerHTML="Start",e.style.display="none",i.style.display="none",await L(),u.style.display="flex",u.onclick=()=>{p.tokensToPts()};;){if(t.style.display="none",e.style.display="none",i.style.display="none",n.style.display="none",o.style.display="none",await h.newRound(),!(h.getPts()>0)){s.innerHTML+=`<br>Your civilization has crumbled! Made it to round ${h.getRound()} before the ultimate demise of your society.`,r.style.display="none",t.style.display="none",e.style.display="none",i.style.display="none",n.style.display="none",o.style.display="none";break}t.style.display="flex",e.style.display="none",i.style.display="none",n.style.display="none",o.style.display="none",t.innerHTML="Continue to next round",r.innerHTML=`Current points: ${h.getPts()}`,d.innerHTML=`Gold: ${h.getTokens()}`,l.innerHTML=`Respect: ${h.getRespect()}`,await L()}}(a,c,await L(!1,!1,!0))}()})();